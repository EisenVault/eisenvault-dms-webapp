(function(){var f=YAHOO.util.Dom,i=YAHOO.util.Event;var c=Alfresco.util.encodeHTML,e=Alfresco.util.combinePaths,b=Alfresco.util.encodeHTML;Alfresco.dashlet.Notice=function g(j){return Alfresco.dashlet.Notice.superclass.constructor.call(this,"Alfresco.dashlet.Notice",j)};YAHOO.extend(Alfresco.dashlet.Notice,Alfresco.component.Base,{options:{componentId:""},onReady:function a(){},onConfigClick:function d(o){var m=Alfresco.constants.URL_SERVICECONTEXT+"modules/dashlet/config/"+encodeURIComponent(this.options.componentId);i.stopEvent(o);if(!this.configDialog){this.configDialog=new Alfresco.module.SimpleDialog(this.id+"-configDialog").setOptions({width:"50em",templateUrl:Alfresco.constants.URL_SERVICECONTEXT+"modules/notice/config",actionUrl:m,onSuccess:{fn:function k(p){var r=f.get(this.configDialog.id+"-title").value,q=f.get(this.configDialog.id+"-text").value;f.get(this.id+"-title").innerHTML=b(YAHOO.lang.trim(r)!=""?r:this.msg("notice.defaultTitle"));f.get(this.id+"-text").innerHTML=q!=""?q:"<p>"+this.msg("notice.defaultText")+"</p>"},scope:this},doSetupFormsValidation:{fn:function j(p){f.get(this.configDialog.id+"-title").value=f.get(this.id+"-title").innerHTML;f.get(this.configDialog.id+"-text").value=f.get(this.id+"-text").innerHTML;if(!this.configDialog.editor){this.configDialog.editor=new Alfresco.util.RichEditor("tinyMCE",this.configDialog.id+"-text",{height:150,width:404,menu:{},toolbar:"bold italic underline | bullist numlist | forecolor backcolor | undo redo removeformat | link anchor image code",language:"en",statusbar:false,extended_valid_elements:"a[href|target|name],font[face|size|color|style],span[class|align|style],div[class|align|style]"});this.configDialog.editor.render();this.configDialog.editor.subscribe("onKeyUp",this._onTextContentChange,this.configDialog,true);this.configDialog.editor.subscribe("onChange",this._onTextContentChange,this.configDialog,true)}},scope:this},doBeforeFormSubmit:{fn:function n(p){this.configDialog.editor.save()},scope:this}});var l=function(q,p){f.setStyle(p[1].panel.element,"z-index",-1);i.removeListener(document,"focusin")};YAHOO.Bubbling.subscribe("hidePanel",l,this.configDialog)}else{this.configDialog.setOptions({actionUrl:m})}i.on(document,"focusin",function(p){i.stopEvent(p)});this.configDialog.show()},_onTextContentChange:function h(k,j,l){this.editor.save()}})})();